# 数据库压测

## 服务器配置

```bash
阿里云服务器
实例规格： ecs.n2.medium
实例规格族： 共享通用型
镜像ID： win2008_64_ent_r2_cn_40G
CPU： 2核
内存： 8 GB
实例类型： I/O优化
操作系统： Windows Server 2008 R2 企业...
公网IP： 111.111.111.111
内网IP： 172.16.0.1
带宽计费方式： 按固定带宽
当前使用带宽： 1Mbps
```

## 第一次压测

压测命令`select name,code,owner,ownerphone from terminals where ownerphone='12345678910'`，terminals中4500条记录

并发500的压测结果：每秒响应数据100次左右CPU负载是25%，0.10%左右的错误率

并发1000的压测结果：每秒响应数据100次左右CPU负载是65%，4分钟后每秒响应量缓慢下降CPU负载也缓慢下降，0.10%左右的错误率

并发2000的压测结果：5分钟内每秒响应数据300次左右CPU负载是65%，5分钟左右响应量忽然降到220左右CPU负载是40%，之后每秒响应量缓慢下降CPU负载也缓慢下降，20分钟左右的时候CPU使用率为30%，0.13%左右的错误率

并发3000的压测结果：5分钟内每秒响应数据300次左右CPU负载是60%，5分钟左右响应量忽然降到220左右CPU负载是40%，之后每秒响应量缓慢下降CPU负载也缓慢下降，20分钟左右的时候CPU使用率为30%，0.15%左右的错误率

## 第二次压测

压测命令`select name,code,owner,ownerphone from terminals where online=0 and ownerphone like '13840%';`

并发500的压测结果：24.7%左右的错误率，每秒响应数据170左右次，CPU负载是40%，100千字节左右I/O

## 总结

数据库主要压力源于I/O